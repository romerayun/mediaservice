(()=>{function e(){startDate=$("#start-date-hidden").val(),endDate=$("#end-date-hidden").val(),recurringRule={freq:"daily",dtstart:startDate,interval:"1",byday:"",bysetpos:"",bymonthday:"",bymonth:"",count:"",until:endDate},$("span.freq-selection").text("день(я,ей)"),$("#monthday-select,#bymonth-select,#weekday-select").hide(),$('input[name="interval"]').val("1"),$('input[name="count"]').val("1"),$('select[name="freq"]').val("daily"),$('input[id="until-select"]').prop("checked",!1),$('input[id="end-no"]').prop("checked",!0).change()}$(document).ready((function(){e()})),$('input[name="event-recurring"]').change((function(){e(),1==$(this).prop("checked")?($("#recurring-rules").slideDown(),$("#until-rules").show()):$("#recurring-rules").hide()})),$(document).on("change",'select[name="freq"]',(function(){selectedFrequency=$('select[name="freq"] option:selected').attr("class"),selectedFrequencyName=$('select[name="freq"] option:selected').attr("attr-name"),$("#recurring-rules > div").hide(),$("div."+selectedFrequency+"-choice").show(),$("span.freq-selection").text(selectedFrequencyName),$("#until-rules").show(),recurringRule={freq:"",dtstart:$("#start-date-hidden").val(),interval:"1",byday:"",bysetpos:"",bymonthday:"",bymonth:"",count:"",until:""},$('input[id="end-no"]').prop("checked",!0).change(),recurringRule.freq=$('select[name="freq"] option:selected').val(),"yearly"==recurringRule.freq&&$('select[name="yearly-bymonth"]').change()})),$(document).on("change blur keyup",'input[name="interval"]',(function(){recurringRule.interval=$(this).val()})),$("#weekday-select label").on("click",(function(){var e=[];setTimeout((function(){$("#weekday-select input:checked").each((function(){e.push($(this).attr("id"))})),recurringRule.byday=e}),100)})),$("#monthday-select label").on("click",(function(){var e=[];setTimeout((function(){$("#monthday-select input:checked").each((function(){null!=$(this).attr("data-day-num")&&e.push($(this).attr("data-day-num"))})),recurringRule.bymonthday=e,recurringRule.byday="",recurringRule.bysetpos=""}),100)})),$("#bymonth-select label").on("click",(function(){var e=[];setTimeout((function(){$("#bymonth-select input:checked").each((function(){null!=$(this).attr("data-month-num")&&e.push($(this).attr("data-month-num"))})),recurringRule.bymonth=e}),100)})),$('input[name="monthday-pos-select"]').change((function(){var e=$(this).val();$('input[name="monthday-pos-select"]').each((function(){if($(this).val()==e)switch($(this).val()){case"month-byday-pos-selected":$("#monthday-select input[type=checkbox]").attr("disabled","disabled"),$('select[name^="month-byday"]').removeAttr("disabled"),$('select[name^="month-byday"]').change(),recurringRule.bymonthday="";break;case"monthday-selected":$("#monthday-select input[type=checkbox]").removeAttr("disabled"),$('select[name^="month-byday"]').attr("disabled","disabled"),recurringRule.byday="",recurringRule.bysetpos=""}}))})),$('input[name="yearly-options"]').change((function(){var e=$(this).attr("id");$('input[name="yearly-options"]').each((function(){if($(this).attr("id")==e)switch($(this).attr("id")){case"yearly-one-month":recurringRule.bysetpos="",recurringRule.byday="",$('select[class*="yearly"]').attr("disabled","disabled"),$(".yearly-multiple-months input[type=checkbox]").attr("disabled","disabled"),$("select.yearly-one-month").removeAttr("disabled"),$('select[name="yearly-bymonth"]').change();break;case"yearly-multiple-months":recurringRule.bymonthday="",recurringRule.byday="",recurringRule.bysetpos="",$('select[class*="yearly"]').attr("disabled","disabled"),$(".yearly-multiple-months input[type=checkbox]").removeAttr("disabled");break;case"yearly-precise":recurringRule.bymonthday="",$('select[class*="yearly"]').attr("disabled","disabled"),$(".yearly-multiple-months input[type=checkbox]").attr("disabled","disabled"),$("select.yearly-precise").removeAttr("disabled"),$('select[name="yearly-bysetpos"]').change()}}))})),$(document).on("change",'select[name^="yearly-bymonth"]',(function(){var e=$('select[name="yearly-bymonth"]').val(),t=$('select[name="yearly-bymonthday"]').val();recurringRule.bymonth=e,recurringRule.bymonthday=t})),$(document).on("click",".yearly-multiple-months label",(function(){var e=[];setTimeout((function(){$(".yearly-multiple-months input:checked").each((function(){null!=$(this).attr("data-month-num")&&e.push($(this).attr("data-month-num"))})),recurringRule.bymonth=e}),100)})),$(document).on("change",'select[name="yearly-bysetpos"], select[name="yearly-byday"], select[name="yearly-bymonth-with-bysetpos-byday"]',(function(){var e=$('select[name="yearly-bysetpos"]').val(),t=$('select[name="yearly-byday"]').val().split(","),n=$('select[name="yearly-bymonth-with-bysetpos-byday"]').val();recurringRule.bymonthday="",recurringRule.bymonth=n,recurringRule.byday=t,recurringRule.bysetpos=e})),$(document).on("change",'select[name^="month-byday"]',(function(){var e=$('select[name="month-byday-pos"]').val(),t=$('select[name="month-byday-pos-name"]').val().split(",");recurringRule.bysetpos=e,recurringRule.byday=t})),$(document).on("input change",'input[name="count"]',(function(){recurringRule.count=$(this).val()})),$('input[name="end-select"]').change((function(){var e=$(this).val();$('input[name="end-select"]').each((function(){if($(this).val()==e)$('input[name="'+e+'"]').removeAttr("disabled"),"until"==$(this).val()?(recurringRule.count="",recurringRule.until=$("#end-date-hidden").val()):"not"==$(this).val()?(recurringRule.count="",recurringRule.until=""):"count"==$(this).val()&&(recurringRule.count=$('input[name="count"]').val(),recurringRule.until="");else{$(this).next("input").attr("disabled","disabled").val("");var t=$(this).next("input").attr("name");recurringRule[t]=""}}))})),document.querySelector("#saveG").addEventListener("click",(function(){1==$('input[name="event-recurring"]').prop("checked")?$("#rrule").val(function(){for(var e in rrule="",""==recurringRule.count&&recurringRule.until,recurringRule)recurringRule.hasOwnProperty(e)&&""!=recurringRule[e]&&(rrule+=e+"="+recurringRule[e]+";");return rrule=rrule.replace(/;\s*$/,""),rrule.toUpperCase()}()):$("#rrule").val("")}))})();